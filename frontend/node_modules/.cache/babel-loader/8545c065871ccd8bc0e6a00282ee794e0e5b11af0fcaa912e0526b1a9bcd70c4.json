{"ast":null,"code":"import axios from\"axios\";import React,{useContext,useEffect,useReducer,useState}from\"react\";import Form from\"react-bootstrap/Form\";import{Helmet}from\"react-helmet-async\";import{useNavigate,useParams}from\"react-router-dom\";import{toast}from\"react-toastify\";import LoadingBox from\"../components/LoadingBox\";import MessageBox from\"../components/MessageBox\";import{Store}from\"../Store\";import{getError}from\"../utils\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const reducer=(state,action)=>{switch(action.type){case\"FETCH_REQUEST\":return{...state,loading:true};case\"FETCH_SUCCESS\":return{...state,loading:false};case\"FETCH_FAIL\":return{...state,loading:false,error:action.payload};case\"UPDATE_REQUEST\":return{...state,loadingUpdate:true};case\"UPDATE_SUCCESS\":return{...state,loadingUpdate:false};case\"UPDATE_FAIL\":return{...state,loadingUpdate:false};default:return state;}};export default function UserEditScreen(){const[{loading,error,loadingUpdate},dispatch]=useReducer(reducer,{loading:true,error:\"\"});const{state}=useContext(Store);const{userInfo}=state;const params=useParams();const{id:userId}=params;const navigate=useNavigate();const[name,setName]=useState(\"\");const[email,setEmail]=useState(\"\");const[isAdmin,setIsAdmin]=useState(false);useEffect(()=>{const fetchData=async()=>{try{dispatch({type:\"FETCH_REQUEST\"});const{data}=await axios.get(\"/api/users/\".concat(userId),{headers:{Authorization:\"Bearer \".concat(userInfo.token)}});setName(data.name);setEmail(data.email);setIsAdmin(data.isAdmin);dispatch({type:\"FETCH_SUCCESS\"});}catch(err){dispatch({type:\"FETCH_FAIL\",payload:getError(err)});}};fetchData();},[userId,userInfo]);const submitHandler=async e=>{e.preventDefault();try{dispatch({type:\"UPDATE_REQUEST\"});await axios.put(\"/api/users/\".concat(userId),{_id:userId,name,email,isAdmin},{headers:{Authorization:\"Bearer \".concat(userInfo.token)}});dispatch({type:\"UPDATE_SUCCESS\"});toast.success(\"User updated successfully\");navigate(\"/admin/users\");}catch(error){toast.error(getError(error));dispatch({type:\"UPDATE_FAIL\"});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"margin-holder profile-screen\",children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsxs(\"title\",{children:[\"Edit User $\",userId]})}),/*#__PURE__*/_jsxs(\"h1\",{className:\"new-font\",children:[\"Edit User \",userId]}),loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{value:name,onChange:e=>setName(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email\"}),/*#__PURE__*/_jsx(Form.Control,{value:email,type:\"email\",onChange:e=>setEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsx(Form.Check,{className:\"mb-3\",type:\"checkbox\",id:\"isAdmin\",label:\"isAdmin\",checked:isAdmin,onChange:e=>setIsAdmin(e.target.checked)}),/*#__PURE__*/_jsxs(\"div\",{className:\"center\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:loadingUpdate,className:\"recurring-button\",type:\"submit\",children:\"Update\"}),loadingUpdate&&/*#__PURE__*/_jsx(LoadingBox,{})]})]})]});}","map":{"version":3,"names":["axios","React","useContext","useEffect","useReducer","useState","Form","Helmet","useNavigate","useParams","toast","LoadingBox","MessageBox","Store","getError","jsxs","_jsxs","jsx","_jsx","reducer","state","action","type","loading","error","payload","loadingUpdate","UserEditScreen","dispatch","userInfo","params","id","userId","navigate","name","setName","email","setEmail","isAdmin","setIsAdmin","fetchData","data","get","concat","headers","Authorization","token","err","submitHandler","e","preventDefault","put","_id","success","className","children","variant","onSubmit","Group","controlId","Label","Control","value","onChange","target","required","Check","label","checked","disabled"],"sources":["/Users/jtlovato/Documents/GitHub/AOPortfolio/AyodelePortfolio/frontend/src/screens/UserEditScreen.js"],"sourcesContent":["import axios from \"axios\";\nimport React, { useContext, useEffect, useReducer, useState } from \"react\";\nimport Form from \"react-bootstrap/Form\";\nimport { Helmet } from \"react-helmet-async\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport LoadingBox from \"../components/LoadingBox\";\nimport MessageBox from \"../components/MessageBox\";\nimport { Store } from \"../Store\";\nimport { getError } from \"../utils\";\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"FETCH_REQUEST\":\n      return { ...state, loading: true };\n    case \"FETCH_SUCCESS\":\n      return { ...state, loading: false };\n    case \"FETCH_FAIL\":\n      return { ...state, loading: false, error: action.payload };\n    case \"UPDATE_REQUEST\":\n      return { ...state, loadingUpdate: true };\n    case \"UPDATE_SUCCESS\":\n      return { ...state, loadingUpdate: false };\n    case \"UPDATE_FAIL\":\n      return { ...state, loadingUpdate: false };\n    default:\n      return state;\n  }\n};\n\nexport default function UserEditScreen() {\n  const [{ loading, error, loadingUpdate }, dispatch] = useReducer(reducer, {\n    loading: true,\n    error: \"\",\n  });\n\n  const { state } = useContext(Store);\n  const { userInfo } = state;\n\n  const params = useParams();\n  const { id: userId } = params;\n  const navigate = useNavigate();\n\n  const [name, setName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [isAdmin, setIsAdmin] = useState(false);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        dispatch({ type: \"FETCH_REQUEST\" });\n        const { data } = await axios.get(`/api/users/${userId}`, {\n          headers: { Authorization: `Bearer ${userInfo.token}` },\n        });\n        setName(data.name);\n        setEmail(data.email);\n        setIsAdmin(data.isAdmin);\n        dispatch({ type: \"FETCH_SUCCESS\" });\n      } catch (err) {\n        dispatch({\n          type: \"FETCH_FAIL\",\n          payload: getError(err),\n        });\n      }\n    };\n    fetchData();\n  }, [userId, userInfo]);\n\n  const submitHandler = async (e) => {\n    e.preventDefault();\n    try {\n      dispatch({ type: \"UPDATE_REQUEST\" });\n      await axios.put(\n        `/api/users/${userId}`,\n        { _id: userId, name, email, isAdmin },\n        {\n          headers: { Authorization: `Bearer ${userInfo.token}` },\n        }\n      );\n      dispatch({\n        type: \"UPDATE_SUCCESS\",\n      });\n      toast.success(\"User updated successfully\");\n      navigate(\"/admin/users\");\n    } catch (error) {\n      toast.error(getError(error));\n      dispatch({ type: \"UPDATE_FAIL\" });\n    }\n  };\n  return (\n    <div className='margin-holder profile-screen'>\n      <Helmet>\n        <title>Edit User ${userId}</title>\n      </Helmet>\n      <h1 className='new-font'>Edit User {userId}</h1>\n\n      {loading ? (\n        <LoadingBox></LoadingBox>\n      ) : error ? (\n        <MessageBox variant='danger'>{error}</MessageBox>\n      ) : (\n        <Form onSubmit={submitHandler}>\n          <Form.Group className='mb-3' controlId='name'>\n            <Form.Label>Name</Form.Label>\n            <Form.Control\n              value={name}\n              onChange={(e) => setName(e.target.value)}\n              required\n            />\n          </Form.Group>\n          <Form.Group className='mb-3' controlId='email'>\n            <Form.Label>Email</Form.Label>\n            <Form.Control\n              value={email}\n              type='email'\n              onChange={(e) => setEmail(e.target.value)}\n              required\n            />\n          </Form.Group>\n\n          <Form.Check\n            className='mb-3'\n            type='checkbox'\n            id='isAdmin'\n            label='isAdmin'\n            checked={isAdmin}\n            onChange={(e) => setIsAdmin(e.target.checked)}\n          />\n\n          <div className='center'>\n            <button\n              disabled={loadingUpdate}\n              className='recurring-button'\n              type='submit'\n            >\n              Update\n            </button>\n            {loadingUpdate && <LoadingBox></LoadingBox>}\n          </div>\n        </Form>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}