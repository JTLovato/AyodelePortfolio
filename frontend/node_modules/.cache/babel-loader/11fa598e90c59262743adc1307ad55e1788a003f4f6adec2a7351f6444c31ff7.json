{"ast":null,"code":"import axios from\"axios\";import{useContext,useEffect,useReducer}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import Row from\"react-bootstrap/Row\";import Col from\"react-bootstrap/Col\";import Card from\"react-bootstrap/Card\";import ListGroup from\"react-bootstrap/ListGroup\";import Badge from\"react-bootstrap/Badge\";import Button from\"react-bootstrap/Button\";import Rating from\"../components/Rating\";import{Helmet}from\"react-helmet-async\";import LoadingBox from\"../components/LoadingBox\";import MessageBox from\"../components/MessageBox\";import{getError}from\"../utils\";import{Store}from\"../Store\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const reducer=(state,action)=>{switch(action.type){case\"FETCH_REQUEST\":return{...state,loading:true};case\"FETCH_SUCCESS\":return{...state,product:action.payload,loading:false};case\"FETCH_FAIL\":return{...state,loading:false,error:action.payload};default:return state;}};function ProductScreen(){const navigate=useNavigate();const params=useParams();const{slug}=params;const[{loading,error,product},dispatch]=useReducer(reducer,{product:[],loading:true,error:\"\"});useEffect(()=>{const fetchData=async()=>{dispatch({type:\"FETCH_REQUEST\"});try{const result=await axios.get(\"/api/products/slug/\".concat(slug));dispatch({type:\"FETCH_SUCCESS\",payload:result.data});}catch(err){dispatch({type:\"FETCH_FAIL\",payload:getError(err)});}};fetchData();},[slug]);const{state,dispatch:ctxDispatch}=useContext(Store);const{cart}=state;const addToCartHandler=async()=>{const existItem=cart.cartItems.find(x=>x._id===product._id);const quantity=existItem?existItem.quantity+1:1;const{data}=await axios.get(\"/api/products/\".concat(product._id));if(data.countInStock<quantity){window.alert(\"Sorry. Product is out of stock\");return;}ctxDispatch({type:\"CART_ADD_ITEM\",payload:{...product,quantity}});navigate(\"/cart\");};return loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(\"img\",{className:\"img-large\",src:product.image,alt:product.name})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:product.name})}),/*#__PURE__*/_jsx(\"h1\",{children:product.name})]}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews})}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Pirce : $\",product.price]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Description:\",/*#__PURE__*/_jsx(\"p\",{children:product.description})]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Price:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",product.price]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Status:\"}),/*#__PURE__*/_jsx(Col,{children:product.countInStock>0?/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"In Stock\"}):/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:\"Unavailable\"})})]})}),product.countInStock>0&&/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsx(Button,{onClick:addToCartHandler,variant:\"primary\",children:\"Add to Cart\"})})})]})})})})]})});}export default ProductScreen;","map":{"version":3,"names":["axios","useContext","useEffect","useReducer","useNavigate","useParams","Row","Col","Card","ListGroup","Badge","Button","Rating","Helmet","LoadingBox","MessageBox","getError","Store","jsx","_jsx","jsxs","_jsxs","reducer","state","action","type","loading","product","payload","error","ProductScreen","navigate","params","slug","dispatch","fetchData","result","get","concat","data","err","ctxDispatch","cart","addToCartHandler","existItem","cartItems","find","x","_id","quantity","countInStock","window","alert","variant","children","md","className","src","image","alt","name","Item","rating","numReviews","price","description","Body","bg","onClick"],"sources":["/Users/jtlovato/Documents/base/base/frontend/src/screens/ProductScreen.js"],"sourcesContent":["import axios from \"axios\";\nimport { useContext, useEffect, useReducer } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Card from \"react-bootstrap/Card\";\nimport ListGroup from \"react-bootstrap/ListGroup\";\nimport Badge from \"react-bootstrap/Badge\";\nimport Button from \"react-bootstrap/Button\";\nimport Rating from \"../components/Rating\";\nimport { Helmet } from \"react-helmet-async\";\nimport LoadingBox from \"../components/LoadingBox\";\nimport MessageBox from \"../components/MessageBox\";\nimport { getError } from \"../utils\";\nimport { Store } from \"../Store\";\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"FETCH_REQUEST\":\n      return { ...state, loading: true };\n    case \"FETCH_SUCCESS\":\n      return { ...state, product: action.payload, loading: false };\n    case \"FETCH_FAIL\":\n      return { ...state, loading: false, error: action.payload };\n    default:\n      return state;\n  }\n};\n\nfunction ProductScreen() {\n  const navigate = useNavigate();\n  const params = useParams();\n  const { slug } = params;\n\n  const [{ loading, error, product }, dispatch] = useReducer(reducer, {\n    product: [],\n    loading: true,\n    error: \"\",\n  });\n  useEffect(() => {\n    const fetchData = async () => {\n      dispatch({ type: \"FETCH_REQUEST\" });\n      try {\n        const result = await axios.get(`/api/products/slug/${slug}`);\n        dispatch({ type: \"FETCH_SUCCESS\", payload: result.data });\n      } catch (err) {\n        dispatch({ type: \"FETCH_FAIL\", payload: getError(err) });\n      }\n    };\n    fetchData();\n  }, [slug]);\n\n  const { state, dispatch: ctxDispatch } = useContext(Store);\n  const { cart } = state;\n  const addToCartHandler = async () => {\n    const existItem = cart.cartItems.find((x) => x._id === product._id);\n    const quantity = existItem ? existItem.quantity + 1 : 1;\n    const { data } = await axios.get(`/api/products/${product._id}`);\n    if (data.countInStock < quantity) {\n      window.alert(\"Sorry. Product is out of stock\");\n      return;\n    }\n    ctxDispatch({\n      type: \"CART_ADD_ITEM\",\n      payload: { ...product, quantity },\n    });\n    navigate(\"/cart\");\n  };\n  return loading ? (\n    <LoadingBox />\n  ) : error ? (\n    <MessageBox variant='danger'>{error}</MessageBox>\n  ) : (\n    <div>\n      <Row>\n        <Col md={6}>\n          <img\n            className='img-large'\n            src={product.image}\n            alt={product.name}\n          ></img>\n        </Col>\n        <Col md={3}>\n          <ListGroup variant='flush'>\n            <ListGroup.Item>\n              <Helmet>\n                <title>{product.name}</title>\n              </Helmet>\n              <h1>{product.name}</h1>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <Rating\n                rating={product.rating}\n                numReviews={product.numReviews}\n              ></Rating>\n            </ListGroup.Item>\n            <ListGroup.Item>Pirce : ${product.price}</ListGroup.Item>\n            <ListGroup.Item>\n              Description:\n              <p>{product.description}</p>\n            </ListGroup.Item>\n          </ListGroup>\n        </Col>\n        <Col md={3}>\n          <Card>\n            <Card.Body>\n              <ListGroup variant='flush'>\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Price:</Col>\n                    <Col>${product.price}</Col>\n                  </Row>\n                </ListGroup.Item>\n                <ListGroup.Item>\n                  <Row>\n                    <Col>Status:</Col>\n                    <Col>\n                      {product.countInStock > 0 ? (\n                        <Badge bg='success'>In Stock</Badge>\n                      ) : (\n                        <Badge bg='danger'>Unavailable</Badge>\n                      )}\n                    </Col>\n                  </Row>\n                </ListGroup.Item>\n\n                {product.countInStock > 0 && (\n                  <ListGroup.Item>\n                    <div className='d-grid'>\n                      <Button onClick={addToCartHandler} variant='primary'>\n                        Add to Cart\n                      </Button>\n                    </div>\n                  </ListGroup.Item>\n                )}\n              </ListGroup>\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n    </div>\n  );\n}\nexport default ProductScreen;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,UAAU,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CACzD,OAASC,WAAW,CAAEC,SAAS,KAAQ,kBAAkB,CACzD,MAAO,CAAAC,GAAG,KAAM,qBAAqB,CACrC,MAAO,CAAAC,GAAG,KAAM,qBAAqB,CACrC,MAAO,CAAAC,IAAI,KAAM,sBAAsB,CACvC,MAAO,CAAAC,SAAS,KAAM,2BAA2B,CACjD,MAAO,CAAAC,KAAK,KAAM,uBAAuB,CACzC,MAAO,CAAAC,MAAM,KAAM,wBAAwB,CAC3C,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CACzC,OAASC,MAAM,KAAQ,oBAAoB,CAC3C,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CACjD,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CACjD,OAASC,QAAQ,KAAQ,UAAU,CACnC,OAASC,KAAK,KAAQ,UAAU,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEjC,KAAM,CAAAC,OAAO,CAAGA,CAACC,KAAK,CAAEC,MAAM,GAAK,CACjC,OAAQA,MAAM,CAACC,IAAI,EACjB,IAAK,eAAe,CAClB,MAAO,CAAE,GAAGF,KAAK,CAAEG,OAAO,CAAE,IAAK,CAAC,CACpC,IAAK,eAAe,CAClB,MAAO,CAAE,GAAGH,KAAK,CAAEI,OAAO,CAAEH,MAAM,CAACI,OAAO,CAAEF,OAAO,CAAE,KAAM,CAAC,CAC9D,IAAK,YAAY,CACf,MAAO,CAAE,GAAGH,KAAK,CAAEG,OAAO,CAAE,KAAK,CAAEG,KAAK,CAAEL,MAAM,CAACI,OAAQ,CAAC,CAC5D,QACE,MAAO,CAAAL,KAAK,CAChB,CACF,CAAC,CAED,QAAS,CAAAO,aAAaA,CAAA,CAAG,CACvB,KAAM,CAAAC,QAAQ,CAAG3B,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAA4B,MAAM,CAAG3B,SAAS,CAAC,CAAC,CAC1B,KAAM,CAAE4B,IAAK,CAAC,CAAGD,MAAM,CAEvB,KAAM,CAAC,CAAEN,OAAO,CAAEG,KAAK,CAAEF,OAAQ,CAAC,CAAEO,QAAQ,CAAC,CAAG/B,UAAU,CAACmB,OAAO,CAAE,CAClEK,OAAO,CAAE,EAAE,CACXD,OAAO,CAAE,IAAI,CACbG,KAAK,CAAE,EACT,CAAC,CAAC,CACF3B,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiC,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5BD,QAAQ,CAAC,CAAET,IAAI,CAAE,eAAgB,CAAC,CAAC,CACnC,GAAI,CACF,KAAM,CAAAW,MAAM,CAAG,KAAM,CAAApC,KAAK,CAACqC,GAAG,uBAAAC,MAAA,CAAuBL,IAAI,CAAE,CAAC,CAC5DC,QAAQ,CAAC,CAAET,IAAI,CAAE,eAAe,CAAEG,OAAO,CAAEQ,MAAM,CAACG,IAAK,CAAC,CAAC,CAC3D,CAAE,MAAOC,GAAG,CAAE,CACZN,QAAQ,CAAC,CAAET,IAAI,CAAE,YAAY,CAAEG,OAAO,CAAEZ,QAAQ,CAACwB,GAAG,CAAE,CAAC,CAAC,CAC1D,CACF,CAAC,CACDL,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,CAACF,IAAI,CAAC,CAAC,CAEV,KAAM,CAAEV,KAAK,CAAEW,QAAQ,CAAEO,WAAY,CAAC,CAAGxC,UAAU,CAACgB,KAAK,CAAC,CAC1D,KAAM,CAAEyB,IAAK,CAAC,CAAGnB,KAAK,CACtB,KAAM,CAAAoB,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,KAAM,CAAAC,SAAS,CAAGF,IAAI,CAACG,SAAS,CAACC,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACC,GAAG,GAAKrB,OAAO,CAACqB,GAAG,CAAC,CACnE,KAAM,CAAAC,QAAQ,CAAGL,SAAS,CAAGA,SAAS,CAACK,QAAQ,CAAG,CAAC,CAAG,CAAC,CACvD,KAAM,CAAEV,IAAK,CAAC,CAAG,KAAM,CAAAvC,KAAK,CAACqC,GAAG,kBAAAC,MAAA,CAAkBX,OAAO,CAACqB,GAAG,CAAE,CAAC,CAChE,GAAIT,IAAI,CAACW,YAAY,CAAGD,QAAQ,CAAE,CAChCE,MAAM,CAACC,KAAK,CAAC,gCAAgC,CAAC,CAC9C,OACF,CACAX,WAAW,CAAC,CACVhB,IAAI,CAAE,eAAe,CACrBG,OAAO,CAAE,CAAE,GAAGD,OAAO,CAAEsB,QAAS,CAClC,CAAC,CAAC,CACFlB,QAAQ,CAAC,OAAO,CAAC,CACnB,CAAC,CACD,MAAO,CAAAL,OAAO,cACZP,IAAA,CAACL,UAAU,GAAE,CAAC,CACZe,KAAK,cACPV,IAAA,CAACJ,UAAU,EAACsC,OAAO,CAAC,QAAQ,CAAAC,QAAA,CAAEzB,KAAK,CAAa,CAAC,cAEjDV,IAAA,QAAAmC,QAAA,cACEjC,KAAA,CAACf,GAAG,EAAAgD,QAAA,eACFnC,IAAA,CAACZ,GAAG,EAACgD,EAAE,CAAE,CAAE,CAAAD,QAAA,cACTnC,IAAA,QACEqC,SAAS,CAAC,WAAW,CACrBC,GAAG,CAAE9B,OAAO,CAAC+B,KAAM,CACnBC,GAAG,CAAEhC,OAAO,CAACiC,IAAK,CACd,CAAC,CACJ,CAAC,cACNzC,IAAA,CAACZ,GAAG,EAACgD,EAAE,CAAE,CAAE,CAAAD,QAAA,cACTjC,KAAA,CAACZ,SAAS,EAAC4C,OAAO,CAAC,OAAO,CAAAC,QAAA,eACxBjC,KAAA,CAACZ,SAAS,CAACoD,IAAI,EAAAP,QAAA,eACbnC,IAAA,CAACN,MAAM,EAAAyC,QAAA,cACLnC,IAAA,UAAAmC,QAAA,CAAQ3B,OAAO,CAACiC,IAAI,CAAQ,CAAC,CACvB,CAAC,cACTzC,IAAA,OAAAmC,QAAA,CAAK3B,OAAO,CAACiC,IAAI,CAAK,CAAC,EACT,CAAC,cACjBzC,IAAA,CAACV,SAAS,CAACoD,IAAI,EAAAP,QAAA,cACbnC,IAAA,CAACP,MAAM,EACLkD,MAAM,CAAEnC,OAAO,CAACmC,MAAO,CACvBC,UAAU,CAAEpC,OAAO,CAACoC,UAAW,CACxB,CAAC,CACI,CAAC,cACjB1C,KAAA,CAACZ,SAAS,CAACoD,IAAI,EAAAP,QAAA,EAAC,WAAS,CAAC3B,OAAO,CAACqC,KAAK,EAAiB,CAAC,cACzD3C,KAAA,CAACZ,SAAS,CAACoD,IAAI,EAAAP,QAAA,EAAC,cAEd,cAAAnC,IAAA,MAAAmC,QAAA,CAAI3B,OAAO,CAACsC,WAAW,CAAI,CAAC,EACd,CAAC,EACR,CAAC,CACT,CAAC,cACN9C,IAAA,CAACZ,GAAG,EAACgD,EAAE,CAAE,CAAE,CAAAD,QAAA,cACTnC,IAAA,CAACX,IAAI,EAAA8C,QAAA,cACHnC,IAAA,CAACX,IAAI,CAAC0D,IAAI,EAAAZ,QAAA,cACRjC,KAAA,CAACZ,SAAS,EAAC4C,OAAO,CAAC,OAAO,CAAAC,QAAA,eACxBnC,IAAA,CAACV,SAAS,CAACoD,IAAI,EAAAP,QAAA,cACbjC,KAAA,CAACf,GAAG,EAAAgD,QAAA,eACFnC,IAAA,CAACZ,GAAG,EAAA+C,QAAA,CAAC,QAAM,CAAK,CAAC,cACjBjC,KAAA,CAACd,GAAG,EAAA+C,QAAA,EAAC,GAAC,CAAC3B,OAAO,CAACqC,KAAK,EAAM,CAAC,EACxB,CAAC,CACQ,CAAC,cACjB7C,IAAA,CAACV,SAAS,CAACoD,IAAI,EAAAP,QAAA,cACbjC,KAAA,CAACf,GAAG,EAAAgD,QAAA,eACFnC,IAAA,CAACZ,GAAG,EAAA+C,QAAA,CAAC,SAAO,CAAK,CAAC,cAClBnC,IAAA,CAACZ,GAAG,EAAA+C,QAAA,CACD3B,OAAO,CAACuB,YAAY,CAAG,CAAC,cACvB/B,IAAA,CAACT,KAAK,EAACyD,EAAE,CAAC,SAAS,CAAAb,QAAA,CAAC,UAAQ,CAAO,CAAC,cAEpCnC,IAAA,CAACT,KAAK,EAACyD,EAAE,CAAC,QAAQ,CAAAb,QAAA,CAAC,aAAW,CAAO,CACtC,CACE,CAAC,EACH,CAAC,CACQ,CAAC,CAEhB3B,OAAO,CAACuB,YAAY,CAAG,CAAC,eACvB/B,IAAA,CAACV,SAAS,CAACoD,IAAI,EAAAP,QAAA,cACbnC,IAAA,QAAKqC,SAAS,CAAC,QAAQ,CAAAF,QAAA,cACrBnC,IAAA,CAACR,MAAM,EAACyD,OAAO,CAAEzB,gBAAiB,CAACU,OAAO,CAAC,SAAS,CAAAC,QAAA,CAAC,aAErD,CAAQ,CAAC,CACN,CAAC,CACQ,CACjB,EACQ,CAAC,CACH,CAAC,CACR,CAAC,CACJ,CAAC,EACH,CAAC,CACH,CACN,CACH,CACA,cAAe,CAAAxB,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}